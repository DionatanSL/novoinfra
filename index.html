<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NOC Infraestrutura | Auditoria e Gest√£o Pro</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
    
    <link rel="stylesheet" href="css/style.css">
</head>
<div id="modalZabbixGlobal" class="modal-zabbix" style="display: none;">
    <div class="modal-zabbix-content">
        
        <div class="modal-zabbix-header">
            <h3 style="margin:0; color:white; display:flex; align-items:center; gap:10px;">
                <i class="fas fa-map-marker-alt" style="color:#00d2ff;"></i> 
                ALARMES: <span id="titulo-estado-modal" style="color:#ffcc00;">CARREGANDO...</span>
            </h3>
            
        </div>

        <div class="modal-zabbix-body" id="lista-alarmes-zabbix">
            </div>

        <div class="modal-zabbix-footer">
            <small id="contador-alarmes-modal" style="color:#94a3b8;">Aguardando dados...</small>
            <button onclick="fecharModalZabbix()" class="btn btn-sm btn-secondary">Fechar</button>
        </div>
    </div>
</div>
<body>

    <div class="public-area" id="login-screen">
        <div class="login-box shadow-lg">
            <h2 class="text-title-cyan">Painel Infraestrutura</h2>
            <input id="user" placeholder="Usu√°rio" autocomplete="off">
            <input id="pass" type="password" placeholder="Senha">
            <button onclick="logar()">ACESSAR</button>
        </div>
    </div>

    <div id="dashboard">
        <div class="main">
            <div class="sidebar shadow">
                <h2>INFRA OPERA√á√ïES</h2>
                <li onclick="showPage('home')">üè† Dashboard</li>
        <li onclick="toggleSubMenu('docMenu')">üìö Documenta√ß√£o <i class="fas fa-chevron-down float-end mt-1" style="font-size: 0.7rem;"></i></li>
<div id="docMenu" class="submenu" style="display: none;">
    <li onclick="showPage('equipamentosPage')">üõ†Ô∏è Equipamentos</li>
    
    <li onclick="showPage('dwdmPage')">üìü DWDM</li>
</div>


                <li onclick="toggleSubMenu('popMenu')">üì° POPs <i class="fas fa-chevron-down float-end mt-1" style="font-size: 0.7rem;"></i></li>
                <div id="popMenu" class="submenu">
                    <li onclick="showPage('pops')">üìë Lista de POPs</li>
                    <li class="li-zabbix" onclick="consultarAlarmesGeraisZabbix()">üö® Alarmes Zabbix</li>
                    <li onclick="showPage('geradoresnobreaks')">üóÑÔ∏è Geradores</li>
                    <li onclick="showPage('baterias')">üîã Baterias</li>
                    <li onclick="showPage('energia')">‚ö° Energia</li>
                    <li onclick="showPage('temperatura')">üå°Ô∏è Temperatura</li>
                    <li onclick="showPage('acessopops')">üîê Acesso Pops</li>
                    <div class="sidebar-footer">
    <hr style="border-color: rgba(255,255,255,0.05); margin: 20px 0;">
    <p class="dev-name">Dionatan Lima</p>
    <p class="dev-version">Vers√£o 1.2.5</p>
</div>
                </div>
                <li onclick="efetuarLogout()">üö™ Sair</li>
            </div>

            <div class="content">
           
                <div id="dwdmPage" class="page-content" style="display: none;">
    <div class="container-fluid">
        <h2 class="text-white mb-4">üìü Ger√™ncia DWDM Modular</h2>
        <div class="card bg-dark text-white border-secondary">
            <div class="card-body">
                <p class="text-secondary">Selecione o chassi para visualizar os slots e placas.</p>
                <hr border-secondary>
                
                <div id="conteudoDWDM" class="mt-4">
                    <p style="color: #475569; text-align: center;">Aguardando sele√ß√£o de equipamento...</p>
                </div>
            </div>
        </div>
    </div>
</div>
              <div id="equipamentosPage" class="page-content" style="display: none; width: 100%;">
    <div style="padding: 20px; max-width: 1200px; margin: auto;">
        
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="color: #00d2ff; margin: 0;">üõ†Ô∏è Invent√°rio de Racks</h2>
            <button id="btnVoltarRack" class="btn btn-sm btn-outline-light" style="display: none;" onclick="voltarParaLista()">‚¨Ö Voltar para Lista</button>
        </div>

        <div id="conteudoEquipamentos">
            </div>
    </div>
</div>
                
                <div id="home" class="page active">
  <h1 class="h4 mb-4 d-flex align-items-center gap-3" style="color: #00d2ff; font-weight: 800;">
  
    VIS√ÉO GERAL
</h1>
<div class="row g-3 mb-4">
    <div class="col-md-4">
        <div class="stat-card-slim">
            <div class="stat-icon-glow icon-blue">
                <i class="fas fa-satellite-dish"></i>
            </div>
            <div class="stat-info">
                <span class="stat-label label-blue">POPS ATIVOS</span>
                <span class="stat-value" id="totalPops">76</span>
            </div>
        </div>
    </div>

    <div class="col-md-4">
       <div class="stat-card-slim" id="card-energia-ac">

            <div class="stat-icon-glow icon-yellow">
                <i class="fas fa-bolt"></i>
            </div>
            <div class="stat-info">
                <span class="stat-label label-yellow">ENERGIA AC</span>
          <span class="stat-value" id="valor-energia-ac">NORMAL</span>

            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="stat-card-slim">
            <div class="stat-icon-glow icon-red">
                <i class="fas fa-thermometer-half"></i>
            </div>
            <div class="stat-info">
                <span class="stat-label label-red">TEMPERATURA</span>
                <span class="stat-value">EST√ÅVEL</span>
                
            </div>
        </div>
    </div>
</div>

<div class="row g-3 mb-4">
    <div class="col-12">
        <div class="card-custom">
            <h6 class="text-title-yellow mb-3">üå§Ô∏è CONDI√á√ïES METEOROL√ìGICAS (ESTADOS)</h6>
            <div id="clima-container" class="d-flex justify-content-between flex-wrap">
                </div>
        </div>
    </div>
</div>
<div id="secao-alarmes-zabbix"
     style="background:#0f172a; padding:16px; border-radius:10px; overflow:hidden;">

    <div id="carrossel-zabbix" class="carrossel-zabbix">
        <div id="alarme-track"></div>
    </div>

</div>

    
   

   <div id="container-alarme-ret" style="background: #1e293b; border: 2px solid #ef4444; padding: 15px; border-radius: 10px; display: none; align-items: center; justify-content: center; min-height: 60px; margin-bottom: 20px;">
        <span id="texto-alarme-ret" style="color: #fff; font-weight: bold; font-size: 1.1rem; text-align: center;"></span>
    </div>

    <div id="lista-retificadoras-corpo"></div>

    <div id="secao-home">
        
        <div class="row g-3">
            
            <div class="col-md-4">
                <div class="chart-box-container">
                    <div class="text-title-yellow">Localiza√ß√£o Geogr√°fica</div>
                    <div id="mapa-container"></div>
                </div>
            </div>

            <div class="col-md-4">
    <div class="chart-box-container text-center"
         style="height: 320px; display: flex; flex-direction: column; background: #0f172a; padding: 15px; border-radius: 12px; border: 1px solid #1e293b;">

        <div class="text-title-yellow" style="margin-bottom: 5px;">
            üß≠ MAPA OPERACIONAL
        </div>

        <div id="container-grafico-vdc"
             style="flex: 1; position: relative; width: 100%; min-height: 200px;">

            <!-- MAPA OPERACIONAL -->
             <div class="botoes-estados-container" style="display: flex; gap: 10px; justify-content: center; margin-bottom: 15px; z-index: 10; position: relative;">
    
    <div class="btn-estado" onclick="abrirAlarmesEstado('BA')" id="btn-ba">
        <span class="uf-label">BA</span>
        <span class="uf-count" id="count-ba">--</span>
    </div>

    <div class="btn-estado" onclick="abrirAlarmesEstado('ES')" id="btn-es">
        <span class="uf-label">ES</span>
        <span class="uf-count" id="count-es">--</span>
    </div>

    <div class="btn-estado" onclick="abrirAlarmesEstado('RJ')" id="btn-rj">
        <span class="uf-label">RJ</span>
        <span class="uf-count" id="count-rj">--</span>
    </div>

    <div class="btn-estado" onclick="abrirAlarmesEstado('SP')" id="btn-sp">
        <span class="uf-label">SP</span>
        <span class="uf-count" id="count-sp">--</span>
    </div>

</div>
            <div id="mapa-operacional" class="mapa-grid"></div>

        </div>
    </div>
</div>

            <div class="col-md-4">
                <div class="chart-box-container text-center">
                    <div class="text-title-yellow">Status T√©rmico</div>
                    <canvas id="graficoTermico"></canvas>
                </div>
            </div>

        </div> </div> </div> 



                <div id="pops" class="page card-custom text-start">
                    <h2 class="h5 text-title-cyan">üì° POPs Operacionais (76)</h2>
<div class="container-busca-elite" style="padding: 15px; background: #0f172a;">
    <input type="text" 
           id="inputAutoBuscaPops" 
           oninput="autoFiltroPops()" 
           placeholder="üîç Localizar POP ou ID na Rede..." 
           style="width: 100%; 
                  padding: 15px; 
                  border-radius: 12px; 
                  border: 2px solid #00d2ff; 
                  background: #1e293b; 
                  color: white; 
                  font-size: 1.1rem; 
                  font-weight: bold; 
                  outline: none; 
                  box-shadow: 0 0 15px rgba(0, 210, 255, 0.2); 
                  transition: 0.3s;"
           onfocus="this.style.boxShadow='0 0 30px rgba(0, 210, 255, 0.4)'; this.style.borderColor='#fff';"
           onblur="this.style.boxShadow='0 0 15px rgba(0, 210, 255, 0.2)'; this.style.borderColor='#00d2ff';">
</div>                    <div style="max-height: 500px; overflow-y: auto;">
                        <table id="tabelaPops">
                            <thead><tr><th>POP (Clique para detalhes)</th><th>Status</th></tr></thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <div id="acessopops" class="page">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="h5 m-0 text-title-cyan">üîê Gest√£o de Acesso T√©cnica</h2>
                        <div class="d-flex gap-2">
                            <button onclick="exportarAcessos()" class="btn btn-success btn-sm"><i class="fas fa-file-export"></i> EXPORTAR</button>
                            <button onclick="limparAcessos()" class="btn btn-danger btn-sm"><i class="fas fa-trash"></i> LIMPAR TUDO</button>
                        </div>
                    </div>

                    <div class="row g-3">
                        <div class="col-md-3">
                            <div class="card-custom text-start" style="background: rgba(15, 23, 42, 0.95); padding: 15px;">
                                <h6 class="text-title-yellow mb-3">Novo Registro</h6>
                                <label class="field-label">T√©cnico</label><select id="tecNome"></select>
                                <label class="field-label">Pop</label><select id="tecPop"></select>
                                <label class="field-label">Chave</label>
                                <select id="tecChave" class="form-select mb-2" style="background:#0f172a; color:white; border:1px solid #1e293b;">
                                    <option value="Principal">Principal</option>
                                    <option value="Reserva">Reserva</option>
                                    <option value="Remoto">Remoto</option>
                                    <option value="Acesso Local">Acesso Local</option>
                                </select>
                                <label class="field-label">Coordenador</label><select id="tecCoordenador"></select>
                                <label class="field-label">Manuten√ß√£o</label>
                                <select id="tecMotivo" class="form-select mb-2" style="background:#0f172a; color:white; border:1px solid #1e293b;">
                                    <option value="M PREVENTIVA">M PREVENTIVA</option>
                                    <option value="M CORRETIVA">M CORRETIVA</option>
                                    <option value="VISTORIA">VISTORIA</option>
                                </select>
                                <button onclick="registrarAcesso()" class="btn btn-primary w-100 mt-2">REGISTRAR</button>

<button onclick="window.open('https://172.20.0.82:4445/#/login', '_blank')" class="btn btn-warning w-100 mt-2">
    <i class="fas fa-external-link-alt"></i> CONTROLE DE ACESSO
</button>
                            </div>
                        </div>
                        <div class="col-md-9">
                            <div class="card-custom" style="height:530px; padding:0; display: flex; flex-direction: column;">
                                <div style="flex:1; overflow-y:auto;">
                                    <table id="tabelaAcessos">
                                        <thead>
                                            <tr><th>T√©cnico</th><th>POP</th><th>Chave</th><th>Coordenador</th><th>Motivo</th><th>Entrada</th><th>Devolu√ß√£o</th></tr>
                                        </thead>
                                        <tbody id="corpoAcessos"></tbody>
                                    </table>
                                </div>
                                <div class="pagination-container" id="paginacao"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="energia" class="page card-custom text-start">
                    <h2 class="h5 text-title-cyan mb-4">‚ö° Energia</h2>
    <div class="filter-group">
    <button class="btn-filter active" onclick="filtrarEnergia('TODOS')">Todos</button>
    <button class="btn-filter" onclick="filtrarEnergia('HUAWEI')">Huawei</button>
    <button class="btn-filter" onclick="filtrarEnergia('ZTE')">ZTE</button>
    <button class="btn-filter" onclick="filtrarEnergia('CPS')">CPS</button>
    <button class="btn-filter" onclick="filtrarEnergia('SPS')">SPS</button>
    <button class="btn-filter" onclick="filtrarEnergia('XPS')">XPS</button>
</div>
                    <table id="tabelaEnergia">
                        <thead><tr><th>Identifica√ß√£o da Fonte</th><th>Status</th><th>Tens√£o AC</th><th>Tens√£o DC</th></tr></thead>
                        <tbody id="corpoEnergia"></tbody>
                    </table>
                </div>

                <div id="geradoresnobreaks" class="page card-custom text-start">
                    <h2 class="h5 text-title-cyan mb-4">üóÑÔ∏è Manuten√ß√£o Preventiva de Geradores</h2>
                    <div style="max-height: 550px; overflow-y: auto;">
                        <table id="tabelaGeradores">
                            <thead>
                                <tr><th>Marca</th><th>Pot√™ncia</th><th>Local</th><th>Cidade</th><th>Pr√≥xima Manuten√ß√£o</th><th>Status</th></tr>
                            </thead>
                            <tbody id="corpoGeradores"></tbody>
                        </table>
                    </div>
                </div>

                <div id="temperatura" class="page card-custom text-start">
                    <h2 class="h5 text-title-cyan">üå°Ô∏è Temperatura</h2>
                    <div class="btn-group mb-3">
                        <button class="btn-marca">Ambiente</button>
                        <button class="btn-marca">Interna SW</button>
                        <button class="btn-marca">Interna OLT</button>
                        <button class="btn-marca">Ar condicionados</button>
                        <button class="btn-marca">BTS</button>
                    </div>
                </div>

                <div id="baterias" class="page card-custom text-start">
    <h2 class="h5 text-title-cyan">üîã Gest√£o de Baterias (76 POPs)</h2>
    
<div class="busca-container" style="padding: 15px; background: #0f172a;">
    <input type="text" 
           id="inputAutoBusca" 
           oninput="autoFiltro()" 
           placeholder="üîç Comece a digitar para localizar..." 
           style="width: 100%; 
                  padding: 15px; 
                  border-radius: 12px; 
                  border: 2px solid #00d2ff; 
                  background: #1e293b; 
                  color: white; 
                  font-size: 1.1rem; 
                  font-weight: bold; 
                  outline: none; 
                  box-shadow: 0 0 15px rgba(0, 210, 255, 0.2); 
                  transition: 0.3s;">
</div>    
    <table id="tabelaBaterias">
        <thead>
            <tr><th>Local</th><th>Sa√∫de</th><th>Vdc</th></tr>
        </thead>
        <tbody>
            </tbody>
    </table>
</div>
<div id="modalFoto" class="modal-foto-overlay" onclick="fecharModalFoto()">
    <div class="modal-foto-container" onclick="event.stopPropagation()">
        <span class="modal-foto-fechar" onclick="fecharModalFoto()">&times;</span>
        <img id="imagemAmpliada" src="" alt="Foto do Rack">
        <div id="legendaFoto" style="color: white; margin-top: 10px; font-weight: bold;"></div>
    </div>
</div>
<style>
    .rack-frame {
    width: 350px; margin: 0 auto; background: #020617;
    border: 5px solid #334155; border-radius: 10px; padding: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.5); position: relative;
}
.u-slot {
    height: 22px; display: flex; align-items: center;
    margin-bottom: 2px; background: rgba(255,255,255,0.02);
    font-size: 10px; border-radius: 2px;
}
.u-num { width: 30px; color: #64748b; text-align: center; border-right: 1px solid #1e293b; font-weight: bold; }
.u-name { flex-grow: 1; padding-left: 10px; font-weight: bold; text-transform: uppercase; }
.u-empty { flex-grow: 1; padding-left: 10px; color: #334155; font-style: italic; }

/* Cores Neon */
.u-rede { background: #1e3a8a !important; color: #38bdf8; border-left: 4px solid #38bdf8; }
.u-energia { background: #450a0a !important; color: #f87171; border-left: 4px solid #f87171; }
.u-dc { background: #064e3b !important; color: #4ade80; border-left: 4px solid #4ade80; }
.u-passivo { background: #1e293b !important; color: #94a3b8; }
</style>
<div id="carrossel-zabbix" class="carrossel-zabbix"></div>

<script src="js/data.js"></script>
<script src="js/auth.js"></script>
<script src="js/dashboard.js"></script>
<script src="js/maps.js"></script>
<script src="js/charts.js"></script>
<script src="js/database.js"></script>
<script src="js/equipamentos_dados.js"></script>
<script src="js/dwdm.js"></script>

<!-- MOTOR ZABBIX -->
<script src="js/script.js"></script>

<!-- MAPA OPERACIONAL (DEPOIS DO MOTOR) -->
<script src="js/mapa-operacional.js"></script>
